include ../Makefile.inc

OUTPUT_FILES=$(PUBNUB_LUA)
PLATFORM=Corona

.PHONY: all
all: build

.PHONY: build
build: $(PUBNUB_LUA)

$(PUBNUB_LUA): $(PUBNUB_COMMON_LUA) $(PUBNUB_NODE_LUA)
	$(ECHO) "-- Version: $(VERSION)" > $(PUBNUB_LUA)
	cat $(PUBNUB_COMMON_LUA) $(PUBNUB_PLATFORM_LUA) >> $(PUBNUB_LUA)
	sed -i -e  "s/VERSION/$(VERSION)/g" $(PUBNUB_LUA)
	sed -i -e  "s/PLATFORM/$(PLATFORM)/g" $(PUBNUB_LUA)
	cp ../common/PubnubUtil.lua tests/unit-tests/
	cp ../common/BinDecHex.lua tests/unit-tests/
	cp pubnub.lua tests/unit-tests/

.PHONY: clean
clean:
	rm -f $(OUTPUT_FILES)

.PHONY: test
test:
	pass

include ../Makefile.post
